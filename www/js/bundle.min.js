function Keyboard(e){this.el=document.querySelectorAll("main")[0],this.canvas=document.getElementsByTagName("canvas")[0],this.keyMap=void 0,this.pathPoints=[],this.debug={},this.props={},paper.setup(this.canvas),this.init(),this.draw()}var Loader={queue:void 0,init:function(){this.queue=new createjs.LoadQueue,this.queue.on("complete",this.onLoadCompleted),this.queue.on("error",this.onLoadError),this.queue.on("progress",this.onLoadProgress)},load:function(e,t){console.log("Loading:",e[0].src);var n=this.queue;n.on("complete",t),n.loadManifest(e)},getContentById:function(e){return this.queue.getResult(e)},onLoadCompleted:function(){console.log("Load Completed")},onLoadError:function(){console.log("Load Error")},onLoadProgress:function(){console.log(".")}},App={container:void 0,init:function(e){this.container=e,Loader.init(),this.initialLoad()},initialLoad:function(){Loader.load([{id:"homepage",src:"data/homepage.html"}],this.loadCompleted.bind(this))},loadCompleted:function(){this.container.innerHTML=Loader.getContentById("homepage"),this.initialTransitionIn()},initialTransitionIn:function(){this.container.classList.add("fade-in"),console.log("[PAN] ‚òëÔ∏è"),Keyboard=new Keyboard},dispose:function(){this.container.innerHTML=""}};Keyboard.prototype.init=function(){this.keyMap=["`","1","2","3","4","5","6","7","8","9","0","-","=","backspace","tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","capslock","a","s","d","f","g","h","j","k","l",";","'","enter","shift","z","x","c","v","b","n","m",",",".","/","//shift","control","alt","meta"," ","//meta","//alt","//control"],window.addEventListener("keydown",function(e){this.onKeyDown(e.key.toLowerCase(),e.location),e.preventDefault()}.bind(this)),window.addEventListener("keyup",function(e){this.onKeyUp(e.key.toLowerCase(),e.location),e.preventDefault()}.bind(this)),window.addEventListener("resize",function(e){this.draw()}.bind(this))},Keyboard.prototype.draw=function(){console.log("draw"),paper.project.activeLayer.removeChildren(),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.style="",paper.view.viewSize=new paper.Size(window.innerWidth,window.innerHeight),this.keyboard=new paper.Group,this.path=new paper.Path,this.type=new paper.Group,this.graphics=new paper.Group([this.keyboard,this.path,this.type]),this.graphics.bringToFront(),this.debug.boundingBox=new paper.Path.Rectangle(this.keyboard.bounds),this.debug.boundingBox.position=paper.view.center,this.drawKeyboard(),this.drawPath(),this.graphics.position=paper.view.center,paper.view.draw()},Keyboard.prototype.drawKeyboard=function(e){for(var t=Math.round(.9*paper.view.bounds.width),n=Math.round(.007*paper.view.bounds.width),o=Math.round((t-13*n)/15.5),a=.015*paper.view.bounds.width,i=0;i<13;i++){var r=new paper.Rectangle(new paper.Point(i*(o+n),0),o),p=new paper.Path.Rectangle(r,new paper.Size(4,4));this.keyboard.addChild(p)}var d=new paper.Rectangle(new paper.Point(13*(o+n),0),new paper.Size(1.5*o,o)),h=new paper.Path.Rectangle(d,new paper.Size(4,4));this.keyboard.addChild(h);var s=new paper.Rectangle(new paper.Point(0,o+n),new paper.Size(1.5*o,o)),l=new paper.Path.Rectangle(s,new paper.Size(4,4));this.keyboard.addChild(l);for(var i=0;i<13;i++){var r=new paper.Rectangle(new paper.Point(i*(o+n)+l.bounds.width+n,o+n),o),p=new paper.Path.Rectangle(r,new paper.Size(4,4));this.keyboard.addChild(p)}var w=new paper.Rectangle(new paper.Point(0,2*(o+n)),new paper.Size(1.5*o+n,o)),c=new paper.Path.Rectangle(w,new paper.Size(4,4));this.keyboard.addChild(c);for(var i=0;i<11;i++){var r=new paper.Rectangle(new paper.Point(i*(o+n)+c.bounds.width+n,2*(o+n)),o),p=new paper.Path.Rectangle(r,new paper.Size(4,4));this.keyboard.addChild(p)}var u=new paper.Rectangle(new paper.Point(this.keyboard.lastChild.bounds.topRight.x+n,2*(o+n)),new paper.Size(2*o,o)),b=new paper.Path.Rectangle(u,new paper.Size(4,4));this.keyboard.addChild(b);var g=new paper.Rectangle(new paper.Point(0,3*(o+n)),new paper.Size(2*o+2*n,o)),y=new paper.Path.Rectangle(g,new paper.Size(4,4));this.keyboard.addChild(y);for(var i=0;i<10;i++){var r=new paper.Rectangle(new paper.Point(i*(o+n)+y.bounds.width+n,3*(o+n)),o),p=new paper.Path.Rectangle(r,new paper.Size(4,4));this.keyboard.addChild(p)}var v=new paper.Rectangle(new paper.Point(this.keyboard.lastChild.bounds.topRight.x+n,3*(o+n)),new paper.Point(b.bounds.bottomRight.x,b.bounds.bottomRight.y+n+o)),f=new paper.Path.Rectangle(v,new paper.Size(4,4));this.keyboard.addChild(f);var C=new paper.Rectangle(new paper.Point(0,4*(o+n)),new paper.Size(1.5*o,o)),k=new paper.Path.Rectangle(C,new paper.Size(4,4));this.keyboard.addChild(k);var P=new paper.Rectangle(new paper.Point(1.5*o+n,4*(o+n)),new paper.Size(o+n,o)),R=new paper.Path.Rectangle(P,new paper.Size(4,4));this.keyboard.addChild(R);var m=new paper.Rectangle(new paper.Point(this.keyboard.lastChild.bounds.topRight.x+n,4*(o+n)),new paper.Point(4*o+5*n-n,4*(o+n)+o)),S=new paper.Path.Rectangle(m,new paper.Size(4,4));this.keyboard.addChild(S);var z=new paper.Rectangle(new paper.Point(4*o+5*n,4*(o+n)),new paper.Size(6*o+5*n,o)),L=new paper.Path.Rectangle(z,new paper.Size(4,4));this.keyboard.addChild(L);var x=S.clone();x.position.x=L.bounds.rightCenter.x+S.bounds.width/2+n,this.keyboard.addChild(x);var K=R.clone();K.position.x=this.keyboard.lastChild.bounds.topRight.x+R.bounds.width/2+n,this.keyboard.addChild(K);var B=new paper.Rectangle(new paper.Point(this.keyboard.lastChild.bounds.topRight.x+n,4*(o+n)),new paper.Point(f.bounds.bottomRight.x,f.bounds.bottomRight.y+n+o)),M=new paper.Path.Rectangle(B,new paper.Size(4,4));this.keyboard.addChild(M);var T=new paper.PointText(new paper.Point(h.bounds.bottomRight.x-n,h.bounds.bottomRight.y-n));T.justification="right",T.fontSize=a,T.fontFamily="Roboto",T.fillColor="white",T.content="del",this.type.addChild(T);var q=new paper.PointText(new paper.Point(b.bounds.bottomRight.x-n,b.bounds.bottomRight.y-n));q.justification="right",q.fontSize=a,q.fontFamily="Roboto",q.fillColor="white",q.content="return",this.type.addChild(q),paper.view.bounds.width<1e3&&(q.content="‚Ä¢",T.content="‚Üê"),this.keyboard.style={fillColor:"#808080",strokeColor:new paper.Color(1,1,1,.4),strokeWidth:1.5,shadowColor:new paper.Color(0,0,0,.45),shadowBlur:4,shadowOffset:new paper.Point(0,2)}},Keyboard.prototype.drawPath=function(){this.path.style={strokeWidth:6,fillColor:new paper.Color(0,0,0,0),strokeCap:"round",strokeJoin:"round"},this.path.strokeColor={gradient:{stops:[new paper.Color("#00FFF4"),new paper.Color("#1F00FF")]},origin:this.debug.boundingBox.bounds.leftCenter,destination:this.debug.boundingBox.bounds.rightCenter};for(var e=this.pathPoints.length-1;e>=0;e--)this.path.add(this.keyboard.children[this.pathPoints[e]].bounds.center);this.path.smooth()},Keyboard.prototype.locateKey=function(e,t){var n=null;if(console.log(e),1==t||0==t){for(var o=this.keyMap.length-1;o>=0;o--)this.keyMap[o]==e&&(n=o);null==n&&console.log("No match")}else 2==t&&("meta"==e&&(n=57),"alt"==e&&(n=58),"control"==e&&(n=59),"shift"==e&&(n=52));return n},Keyboard.prototype.onKeyDown=function(e,t){var n=this.locateKey(e,t);return this.pathPoints.push(n),console.log(this.path.segments),this.keyboard.children[n].shadowColor=new paper.Color(0,0,0,.2),this.keyboard.children[n].shadowBlur=1,this.keyboard.children[n].shadowOffset=new paper.Point(0,1),"backspace"==e?void this["delete"]():"enter"==e?void paper.view.draw():(this.path.add(this.keyboard.children[n].bounds.center),this.path.smooth(),void paper.view.draw())},Keyboard.prototype.onKeyUp=function(e,t){for(var n=this.keyboard.children.length-1;n>=0;n--)this.keyboard.children[n].shadowColor=new paper.Color(0,0,0,.45),this.keyboard.children[n].shadowBlur=4,this.keyboard.children[n].shadowOffset=new paper.Point(0,2);"enter"==e&&this.path.segments.length>1&&this.resetAll(),paper.view.draw()},Keyboard.prototype.addToText=function(e){this.text.push(e)},Keyboard.prototype["delete"]=function(){this.path.removeSegment(this.path.segments.length-1),this.text.pop(),paper.view.draw()},Keyboard.prototype.resetAll=function(){this.path.removeSegments(),this.text=[]},document.addEventListener("DOMContentLoaded",function(){console.log("üëª"),App.init(document.getElementById("container"))});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIktleWJvYXJkLmpzIiwibG9hZGVyLmpzIiwiYXBwLmpzIiwiaW5kZXguanMiXSwibmFtZXMiOlsiS2V5Ym9hcmQiLCJwYXJhbWV0ZXJzIiwidGhpcyIsImVsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2FudmFzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJrZXlNYXAiLCJ1bmRlZmluZWQiLCJwYXRoUG9pbnRzIiwiZGVidWciLCJwcm9wcyIsInBhcGVyIiwic2V0dXAiLCJpbml0IiwiZHJhdyIsIkxvYWRlciIsInF1ZXVlIiwiY3JlYXRlanMiLCJMb2FkUXVldWUiLCJvbiIsIm9uTG9hZENvbXBsZXRlZCIsIm9uTG9hZEVycm9yIiwib25Mb2FkUHJvZ3Jlc3MiLCJsb2FkIiwibWFuaWZlc3QiLCJvbkxvYWRlZCIsImNvbnNvbGUiLCJsb2ciLCJzcmMiLCJxIiwibG9hZE1hbmlmZXN0IiwiZ2V0Q29udGVudEJ5SWQiLCJpZCIsImdldFJlc3VsdCIsIkFwcCIsImNvbnRhaW5lciIsImluaXRpYWxMb2FkIiwibG9hZENvbXBsZXRlZCIsImJpbmQiLCJpbm5lckhUTUwiLCJpbml0aWFsVHJhbnNpdGlvbkluIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzcG9zZSIsInByb3RvdHlwZSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwib25LZXlEb3duIiwia2V5IiwidG9Mb3dlckNhc2UiLCJsb2NhdGlvbiIsInByZXZlbnREZWZhdWx0Iiwib25LZXlVcCIsInByb2plY3QiLCJhY3RpdmVMYXllciIsInJlbW92ZUNoaWxkcmVuIiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJzdHlsZSIsInZpZXciLCJ2aWV3U2l6ZSIsIlNpemUiLCJrZXlib2FyZCIsIkdyb3VwIiwicGF0aCIsIlBhdGgiLCJ0eXBlIiwiZ3JhcGhpY3MiLCJicmluZ1RvRnJvbnQiLCJib3VuZGluZ0JveCIsIlJlY3RhbmdsZSIsImJvdW5kcyIsInBvc2l0aW9uIiwiY2VudGVyIiwiZHJhd0tleWJvYXJkIiwiZHJhd1BhdGgiLCJrZXlib2FyZFdpZHRoIiwiTWF0aCIsInJvdW5kIiwibWFyZ2luIiwia2V5U2l6ZSIsInR5cGVTaXplIiwiaSIsIlBvaW50IiwiYWRkQ2hpbGQiLCJkZWwiLCJkZWxLZXkiLCJ0YWIiLCJ0YWJLZXkiLCJjbCIsImNsS2V5IiwicnQiLCJsYXN0Q2hpbGQiLCJ0b3BSaWdodCIsIngiLCJydEtleSIsInNoaWZ0Iiwic2hpZnRLZXkiLCJzaGlmdDIiLCJib3R0b21SaWdodCIsInkiLCJzaGlmdDJLZXkiLCJjdHJsMSIsImN0cmwxS2V5IiwiYWx0MSIsImFsdDFLZXkiLCJjbWQxIiwiY21kMUtleSIsInNwYWNlIiwic3BhY2VLZXkiLCJjbWQyS2V5IiwiY2xvbmUiLCJyaWdodENlbnRlciIsImFsdDJLZXkiLCJjdHJsMiIsImN0cmwyS2V5IiwiZGVsVHlwZSIsIlBvaW50VGV4dCIsImp1c3RpZmljYXRpb24iLCJmb250U2l6ZSIsImZvbnRGYW1pbHkiLCJmaWxsQ29sb3IiLCJjb250ZW50IiwicmV0dXJuVHlwZSIsInN0cm9rZUNvbG9yIiwiQ29sb3IiLCJzdHJva2VXaWR0aCIsInNoYWRvd0NvbG9yIiwic2hhZG93Qmx1ciIsInNoYWRvd09mZnNldCIsInN0cm9rZUNhcCIsInN0cm9rZUpvaW4iLCJncmFkaWVudCIsInN0b3BzIiwib3JpZ2luIiwibGVmdENlbnRlciIsImRlc3RpbmF0aW9uIiwibGVuZ3RoIiwiY2hpbGRyZW4iLCJzbW9vdGgiLCJsb2NhdGVLZXkiLCJpbmRleCIsInB1c2giLCJzZWdtZW50cyIsInJlc2V0QWxsIiwiYWRkVG9UZXh0IiwiY2hhcmFjdGVyIiwidGV4dCIsInJlbW92ZVNlZ21lbnQiLCJwb3AiLCJyZW1vdmVTZWdtZW50cyIsImdldEVsZW1lbnRCeUlkIl0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxVQUFBQyxHQUVBQyxLQUFBQyxHQUFBQyxTQUFBQyxpQkFBQSxRQUFBLEdBQ0FI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QUcsR0FBQXRFLE9BQUFFLFFBQ0E1RSxLQUFBbUUsS0FBQTJFLGFBRUFuSSxPQUFBbUQsS0FBQWhELFNBT0FoQixTQUFBOEMsVUFBQVMsUUFBQSxTQUFBSixFQUFBRSxHQUVBLElBQUEsR0FBQWtDLEdBQUFyRixLQUFBaUUsU0FBQTRFLFNBQUFELE9BQUEsRUFBQXZELEdBQUEsRUFBQUEsSUFFQXJGLEtBQUFpRSxTQUFBNEUsU0FBQXhELEdBQUE2QyxZQUFBLEdBQUF2SCxPQUFBcUgsTUFBQSxFQUFBLEVBQUEsRUFBQSxLQUNBaEksS0FBQWlFLFNBQUE0RSxTQUFBeEQsR0FBQThDLFdBQUEsRUFDQW5JLEtBQUFpRSxTQUFBNEUsU0FBQXhELEdBQUErQyxhQUFBLEdBQUF6SCxPQUFBMkUsTUFBQSxFQUFBLEVBSUEsVUFBQXJDLEdBQ0FqRCxLQUFBbUUsS0FBQStFLFNBQUFOLE9BQUEsR0FDQTVJLEtBQUFtSixXQUlBeEksTUFBQW1ELEtBQUFoRCxRQUdBaEIsU0FBQThDLFVBQUF3RyxVQUFBLFNBQUFDLEdBRUFySixLQUFBc0osS0FBQUwsS0FBQUksSUFJQXZKLFNBQUE4QyxVQUFBOUMsVUFBQSxXQUVBRSxLQUFBbUUsS0FBQW9GLGNBQUF2SixLQUFBbUUsS0FBQStFLFNBQUFOLE9BQUEsR0FDQTVJLEtBQUFzSixLQUFBRSxNQUVBN0ksTUFBQW1ELEtBQUFoRCxRQUlBaEIsU0FBQThDLFVBQUF1RyxTQUFBLFdBRUFuSixLQUFBbUUsS0FBQXNGLGlCQUNBekosS0FBQXNKLFNHdlpBcEosU0FBQTRDLGlCQUFBLG1CQUFBLFdBRUFwQixRQUFBQyxJQUFBLE1BQ0FPLElBQUFyQixLQUFBWCxTQUFBd0osZUFBQSIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gS2V5Ym9hcmQocGFyYW1ldGVycykge1xuXG5cdHRoaXMuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdtYWluJylbMF07XG5cdHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NhbnZhcycpWzBdO1xuXG5cdHRoaXMua2V5TWFwID0gdW5kZWZpbmVkO1xuXHR0aGlzLnBhdGhQb2ludHMgPSBbXTtcblxuXHR0aGlzLmRlYnVnID0ge307XG5cdHRoaXMucHJvcHMgPSB7fTtcblxuXHRwYXBlci5zZXR1cCh0aGlzLmNhbnZhcyk7XG5cdFxuXHR0aGlzLmluaXQoKTtcblx0dGhpcy5kcmF3KCk7XG5cbn1cblxuS2V5Ym9hcmQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuXHR0aGlzLmtleU1hcCA9IFtcblx0XHRcImBcIixcblx0XHRcIjFcIixcblx0XHRcIjJcIixcblx0XHRcIjNcIixcblx0XHRcIjRcIixcblx0XHRcIjVcIixcblx0XHRcIjZcIixcblx0XHRcIjdcIixcblx0XHRcIjhcIixcblx0XHRcIjlcIixcblx0XHRcIjBcIixcblx0XHRcIi1cIixcblx0XHRcIj1cIixcblx0XHRcImJhY2tzcGFjZVwiLFxuXHRcdFwidGFiXCIsXG5cdFx0XCJxXCIsXG5cdFx0XCJ3XCIsXG5cdFx0XCJlXCIsXG5cdFx0XCJyXCIsXG5cdFx0XCJ0XCIsXG5cdFx0XCJ5XCIsXG5cdFx0XCJ1XCIsXG5cdFx0XCJpXCIsXG5cdFx0XCJvXCIsXG5cdFx0XCJwXCIsXG5cdFx0XCJbXCIsXG5cdFx0XCJdXCIsXG5cdFx0XCJcXFxcXCIsXG5cdFx0XCJjYXBzbG9ja1wiLFxuXHRcdFwiYVwiLFxuXHRcdFwic1wiLFxuXHRcdFwiZFwiLFxuXHRcdFwiZlwiLFxuXHRcdFwiZ1wiLFxuXHRcdFwiaFwiLFxuXHRcdFwialwiLFxuXHRcdFwia1wiLFxuXHRcdFwibFwiLFxuXHRcdFwiO1wiLFxuXHRcdFwiJ1wiLFxuXHRcdFwiZW50ZXJcIixcblx0XHRcInNoaWZ0XCIsIC8vIExcblx0XHRcInpcIixcblx0XHRcInhcIixcblx0XHRcImNcIixcblx0XHRcInZcIixcblx0XHRcImJcIixcblx0XHRcIm5cIixcblx0XHRcIm1cIixcblx0XHRcIixcIixcblx0XHRcIi5cIixcblx0XHRcIi9cIixcblx0XHRcIi8vc2hpZnRcIiwgLy8gUlxuXHRcdFwiY29udHJvbFwiLCAvLyBMXG5cdFx0XCJhbHRcIiwgLy8gTFxuXHRcdFwibWV0YVwiLCAvLyBMXG5cdFx0XCIgXCIsIC8vIFNwYWNlYmFyXG5cdFx0XCIvL21ldGFcIiwgLy8gUlxuXHRcdFwiLy9hbHRcIiwgLy8gUlxuXHRcdFwiLy9jb250cm9sXCIgLy8gUlxuXHRdXG5cblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0dGhpcy5vbktleURvd24oZS5rZXkudG9Mb3dlckNhc2UoKSwgZS5sb2NhdGlvbik7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9LmJpbmQodGhpcykpO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcblx0XHR0aGlzLm9uS2V5VXAoZS5rZXkudG9Mb3dlckNhc2UoKSwgZS5sb2NhdGlvbik7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9LmJpbmQodGhpcykpO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbihlKSB7XG5cdFx0dGhpcy5kcmF3KCk7XG5cdH0uYmluZCh0aGlzKSk7XG5cbn1cblxuS2V5Ym9hcmQucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbigpIHtcblxuXHRjb25zb2xlLmxvZyhcImRyYXdcIik7XG5cblx0cGFwZXIucHJvamVjdC5hY3RpdmVMYXllci5yZW1vdmVDaGlsZHJlbigpO1xuXG5cdC8vIFZpZXcgcmVzaXplXG5cdHRoaXMuY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5cdHRoaXMuY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblx0dGhpcy5jYW52YXMuc3R5bGUgPSAnJztcblx0cGFwZXIudmlldy52aWV3U2l6ZSA9IG5ldyBwYXBlci5TaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXG5cdC8vIEluaXQgVUlcblx0dGhpcy5rZXlib2FyZCA9IG5ldyBwYXBlci5Hcm91cCgpO1xuXHR0aGlzLnBhdGggPSBuZXcgcGFwZXIuUGF0aCgpO1xuXHR0aGlzLnR5cGUgPSBuZXcgcGFwZXIuR3JvdXAoKTtcblx0dGhpcy5ncmFwaGljcyA9IG5ldyBwYXBlci5Hcm91cChbdGhpcy5rZXlib2FyZCwgdGhpcy5wYXRoLCB0aGlzLnR5cGVdKTtcblx0dGhpcy5ncmFwaGljcy5icmluZ1RvRnJvbnQoKTtcblxuXHQvLyBEZWJ1Z1xuXHQvLyB0aGlzLmRlYnVnLmNlbnRlciA9IG5ldyBwYXBlci5TaGFwZS5DaXJjbGUobmV3IHBhcGVyLlBvaW50KDgwLCA1MCksIDIpO1xuXHQvLyB0aGlzLmRlYnVnLmNlbnRlci5maWxsQ29sb3IgPSBcInJlZFwiO1xuXHQvLyB0aGlzLmRlYnVnLmNlbnRlci5wb3NpdGlvbiA9IHBhcGVyLnZpZXcuY2VudGVyO1xuXHR0aGlzLmRlYnVnLmJvdW5kaW5nQm94ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHRoaXMua2V5Ym9hcmQuYm91bmRzKTtcblx0dGhpcy5kZWJ1Zy5ib3VuZGluZ0JveC5wb3NpdGlvbiA9IHBhcGVyLnZpZXcuY2VudGVyO1xuXG5cdC8vIERyYXcgVUlcblx0dGhpcy5kcmF3S2V5Ym9hcmQoKTtcblx0dGhpcy5kcmF3UGF0aCgpO1xuXG5cdC8vIFJlc3BvbnNpdmVcblx0dGhpcy5ncmFwaGljcy5wb3NpdGlvbiA9IHBhcGVyLnZpZXcuY2VudGVyO1xuXG5cdHBhcGVyLnZpZXcuZHJhdygpO1xuXG59XG5cbktleWJvYXJkLnByb3RvdHlwZS5kcmF3S2V5Ym9hcmQgPSBmdW5jdGlvbihwcm9wcykge1xuXG5cdC8vIE1BRE5FU1NcblxuXHR2YXIga2V5Ym9hcmRXaWR0aCA9IE1hdGgucm91bmQocGFwZXIudmlldy5ib3VuZHMud2lkdGgqMC45KTtcblx0dmFyIG1hcmdpbiA9IE1hdGgucm91bmQocGFwZXIudmlldy5ib3VuZHMud2lkdGgqMC4wMDcpO1xuXHR2YXIga2V5U2l6ZSA9IE1hdGgucm91bmQoIChrZXlib2FyZFdpZHRoIC0gMTMqbWFyZ2luKSAvIDE1LjUgKTtcblx0dmFyIHR5cGVTaXplID0gcGFwZXIudmlldy5ib3VuZHMud2lkdGgqMC4wMTU7XG5cblx0Ly8gRHJhdyBmaXJzdCBsaW5lXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgMTM7IGkrKykge1xuXHRcdHZhciBwYXRoID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQoaSooa2V5U2l6ZSArIG1hcmdpbiksIDApLCBrZXlTaXplKTtcblx0XHR2YXIga2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHBhdGgsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0XHR0aGlzLmtleWJvYXJkLmFkZENoaWxkKGtleSk7XG5cdH1cblxuXHQvLyBEZWwga2V5IGlzIDEuNXggd2lkZXIgdGhhbiBhIEtleVxuXHR2YXIgZGVsID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQoMTMqKGtleVNpemUgKyBtYXJnaW4pLCAwKSwgbmV3IHBhcGVyLlNpemUoa2V5U2l6ZSoxLjUsIGtleVNpemUpKTtcblx0dmFyIGRlbEtleSA9IG5ldyBwYXBlci5QYXRoLlJlY3RhbmdsZShkZWwsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChkZWxLZXkpO1xuXG5cdC8vIFRhYiBrZXkgaXMgMS41eCB3aWRlciB0aGFuIGEgS2V5XG5cdHZhciB0YWIgPSBuZXcgcGFwZXIuUmVjdGFuZ2xlKG5ldyBwYXBlci5Qb2ludCgwLCBrZXlTaXplICsgbWFyZ2luKSwgbmV3IHBhcGVyLlNpemUoa2V5U2l6ZSoxLjUsIGtleVNpemUpKTtcblx0dmFyIHRhYktleSA9IG5ldyBwYXBlci5QYXRoLlJlY3RhbmdsZSh0YWIsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZCh0YWJLZXkpO1xuXG5cdC8vIERyYXcgc2Vjb25kIGxpbmVcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxMzsgaSsrKSB7XG5cdFx0dmFyIHBhdGggPSBuZXcgcGFwZXIuUmVjdGFuZ2xlKG5ldyBwYXBlci5Qb2ludChpKihrZXlTaXplICsgbWFyZ2luKSArIHRhYktleS5ib3VuZHMud2lkdGggKyBtYXJnaW4sIGtleVNpemUgKyBtYXJnaW4pLCBrZXlTaXplKTtcblx0XHR2YXIga2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHBhdGgsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0XHR0aGlzLmtleWJvYXJkLmFkZENoaWxkKGtleSk7XG5cdH1cblxuXHQvLyBDYXBzbG9jayBrZXkgaXMgMS41eCB3aWRlciB0aGFuIGEgS2V5ICsgbWFyZ2luXG5cdHZhciBjbCA9IG5ldyBwYXBlci5SZWN0YW5nbGUobmV3IHBhcGVyLlBvaW50KDAsIChrZXlTaXplICsgbWFyZ2luKSAqIDIpLCBuZXcgcGFwZXIuU2l6ZShrZXlTaXplKjEuNSArIG1hcmdpbiwga2V5U2l6ZSkpO1xuXHR2YXIgY2xLZXkgPSBuZXcgcGFwZXIuUGF0aC5SZWN0YW5nbGUoY2wsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChjbEtleSk7XG5cblx0Ly8gRHJhdyB0aGlyZCBsaW5lXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgMTE7IGkrKykge1xuXHRcdHZhciBwYXRoID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQoaSooa2V5U2l6ZSArIG1hcmdpbikgKyBjbEtleS5ib3VuZHMud2lkdGggKyBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDIpLCBrZXlTaXplKTtcblx0XHR2YXIga2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHBhdGgsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0XHR0aGlzLmtleWJvYXJkLmFkZENoaWxkKGtleSk7XG5cdH1cblxuXHQvLyBSZXR1cm4ga2V5IGlzIDJ4IHdpZGVyIHRoYW4gYSBLZXlcblx0dmFyIHJ0ID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQodGhpcy5rZXlib2FyZC5sYXN0Q2hpbGQuYm91bmRzLnRvcFJpZ2h0LnggKyBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDIpLCBuZXcgcGFwZXIuU2l6ZShrZXlTaXplKjIsIGtleVNpemUpKTtcblx0dmFyIHJ0S2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHJ0LCBuZXcgcGFwZXIuU2l6ZSg0LCA0KSk7XG5cdHRoaXMua2V5Ym9hcmQuYWRkQ2hpbGQocnRLZXkpO1xuXG5cdC8vIFNoaWZ0IGtleSBpcyAyeCB3aWRlciB0aGFuIGEgS2V5ICsgMiB4IG1hcmdpblxuXHR2YXIgc2hpZnQgPSBuZXcgcGFwZXIuUmVjdGFuZ2xlKG5ldyBwYXBlci5Qb2ludCgwLCAoa2V5U2l6ZSArIG1hcmdpbikgKiAzKSwgbmV3IHBhcGVyLlNpemUoa2V5U2l6ZSoyICsgMiAqIG1hcmdpbiwga2V5U2l6ZSkpO1xuXHR2YXIgc2hpZnRLZXkgPSBuZXcgcGFwZXIuUGF0aC5SZWN0YW5nbGUoc2hpZnQsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChzaGlmdEtleSk7XG5cblx0Ly8gRHJhdyBmb3VydGggbGluZVxuXHRmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcblx0XHR2YXIgcGF0aCA9IG5ldyBwYXBlci5SZWN0YW5nbGUobmV3IHBhcGVyLlBvaW50KGkqKGtleVNpemUgKyBtYXJnaW4pICsgc2hpZnRLZXkuYm91bmRzLndpZHRoICsgbWFyZ2luLCAoa2V5U2l6ZSArIG1hcmdpbikgKiAzKSwga2V5U2l6ZSk7XG5cdFx0dmFyIGtleSA9IG5ldyBwYXBlci5QYXRoLlJlY3RhbmdsZShwYXRoLCBuZXcgcGFwZXIuU2l6ZSg0LCA0KSk7XG5cdFx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChrZXkpO1xuXHR9XG5cblx0Ly8gU2hpZnQga2V5IGlzIDJ4IHdpZGVyIHRoYW4gYSBLZXkgKyAyIHggbWFyZ2luXG5cdHZhciBzaGlmdDIgPSBuZXcgcGFwZXIuUmVjdGFuZ2xlKG5ldyBwYXBlci5Qb2ludCh0aGlzLmtleWJvYXJkLmxhc3RDaGlsZC5ib3VuZHMudG9wUmlnaHQueCArIG1hcmdpbiwgKGtleVNpemUgKyBtYXJnaW4pICogMyksIG5ldyBwYXBlci5Qb2ludChydEtleS5ib3VuZHMuYm90dG9tUmlnaHQueCwgcnRLZXkuYm91bmRzLmJvdHRvbVJpZ2h0LnkgKyBtYXJnaW4gKyBrZXlTaXplKSk7XG5cdHZhciBzaGlmdDJLZXkgPSBuZXcgcGFwZXIuUGF0aC5SZWN0YW5nbGUoc2hpZnQyLCBuZXcgcGFwZXIuU2l6ZSg0LCA0KSk7XG5cdHRoaXMua2V5Ym9hcmQuYWRkQ2hpbGQoc2hpZnQyS2V5KTtcblxuXHQvLyBDdHJsMSBrZXkgaXMgMS41eCB3aWRlciB0aGFuIGEgS2V5XG5cdHZhciBjdHJsMSA9IG5ldyBwYXBlci5SZWN0YW5nbGUobmV3IHBhcGVyLlBvaW50KDAsIChrZXlTaXplICsgbWFyZ2luKSAqIDQpLCBuZXcgcGFwZXIuU2l6ZShrZXlTaXplKjEuNSwga2V5U2l6ZSkpO1xuXHR2YXIgY3RybDFLZXkgPSBuZXcgcGFwZXIuUGF0aC5SZWN0YW5nbGUoY3RybDEsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChjdHJsMUtleSk7XG5cblx0Ly8gQWx0MSBrZXkgaXMgMXgga2V5ICsgMXggbWFyZ2luXG5cdHZhciBhbHQxID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQoMS41KmtleVNpemUgKyBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDQpLCBuZXcgcGFwZXIuU2l6ZShrZXlTaXplICsgbWFyZ2luLCBrZXlTaXplKSk7XG5cdHZhciBhbHQxS2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKGFsdDEsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChhbHQxS2V5KTtcblxuXHQvLyBDb21tYW5kMSBrZXkgaXMgNGtleSArIDVtYXJnaW5zXG5cdHZhciBjbWQxID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQodGhpcy5rZXlib2FyZC5sYXN0Q2hpbGQuYm91bmRzLnRvcFJpZ2h0LnggKyBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDQpLCBuZXcgcGFwZXIuUG9pbnQoa2V5U2l6ZSo0ICsgbWFyZ2luKjUgLSBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDQgKyBrZXlTaXplKSk7XG5cdHZhciBjbWQxS2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKGNtZDEsIG5ldyBwYXBlci5TaXplKDQsIDQpKTtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChjbWQxS2V5KTtcblxuXHQvLyBTcGFjZSBrZXkgaXMgNngga2V5ICsgNXggbWFyZ2luXG5cdHZhciBzcGFjZSA9IG5ldyBwYXBlci5SZWN0YW5nbGUobmV3IHBhcGVyLlBvaW50KDQqa2V5U2l6ZSArIDUqbWFyZ2luLCAoa2V5U2l6ZSArIG1hcmdpbikgKiA0KSwgbmV3IHBhcGVyLlNpemUoNiprZXlTaXplICsgNSptYXJnaW4sIGtleVNpemUpKTtcblx0dmFyIHNwYWNlS2V5ID0gbmV3IHBhcGVyLlBhdGguUmVjdGFuZ2xlKHNwYWNlLCBuZXcgcGFwZXIuU2l6ZSg0LCA0KSk7XG5cdHRoaXMua2V5Ym9hcmQuYWRkQ2hpbGQoc3BhY2VLZXkpO1xuXG5cdHZhciBjbWQyS2V5ID0gY21kMUtleS5jbG9uZSgpO1xuXHRjbWQyS2V5LnBvc2l0aW9uLnggPSBzcGFjZUtleS5ib3VuZHMucmlnaHRDZW50ZXIueCArIGNtZDFLZXkuYm91bmRzLndpZHRoLzIgKyBtYXJnaW47XG5cdHRoaXMua2V5Ym9hcmQuYWRkQ2hpbGQoY21kMktleSk7XG5cblx0dmFyIGFsdDJLZXkgPSBhbHQxS2V5LmNsb25lKCk7XG5cdGFsdDJLZXkucG9zaXRpb24ueCA9IHRoaXMua2V5Ym9hcmQubGFzdENoaWxkLmJvdW5kcy50b3BSaWdodC54ICsgYWx0MUtleS5ib3VuZHMud2lkdGgvMiArIG1hcmdpbjtcblx0dGhpcy5rZXlib2FyZC5hZGRDaGlsZChhbHQyS2V5KTtcblxuXHQvLyBDdHJsMiBrZXkgY29tcGxldGVzIHRoZSBsYXlvdXRcblx0dmFyIGN0cmwyID0gbmV3IHBhcGVyLlJlY3RhbmdsZShuZXcgcGFwZXIuUG9pbnQodGhpcy5rZXlib2FyZC5sYXN0Q2hpbGQuYm91bmRzLnRvcFJpZ2h0LnggKyBtYXJnaW4sIChrZXlTaXplICsgbWFyZ2luKSAqIDQpLCBuZXcgcGFwZXIuUG9pbnQoc2hpZnQyS2V5LmJvdW5kcy5ib3R0b21SaWdodC54LCBzaGlmdDJLZXkuYm91bmRzLmJvdHRvbVJpZ2h0LnkgKyBtYXJnaW4gKyBrZXlTaXplKSk7XG5cdHZhciBjdHJsMktleSA9IG5ldyBwYXBlci5QYXRoLlJlY3RhbmdsZShjdHJsMiwgbmV3IHBhcGVyLlNpemUoNCwgNCkpO1xuXHR0aGlzLmtleWJvYXJkLmFkZENoaWxkKGN0cmwyS2V5KTtcblxuXHQvLyBUeXBlXG5cdHZhciBkZWxUeXBlID0gbmV3IHBhcGVyLlBvaW50VGV4dChuZXcgcGFwZXIuUG9pbnQoZGVsS2V5LmJvdW5kcy5ib3R0b21SaWdodC54IC0gbWFyZ2luLCBkZWxLZXkuYm91bmRzLmJvdHRvbVJpZ2h0LnkgLSBtYXJnaW4pKTtcblx0ZGVsVHlwZS5qdXN0aWZpY2F0aW9uID0gJ3JpZ2h0Jztcblx0ZGVsVHlwZS5mb250U2l6ZSA9IHR5cGVTaXplO1xuXHRkZWxUeXBlLmZvbnRGYW1pbHk9ICdSb2JvdG8nO1xuXHRkZWxUeXBlLmZpbGxDb2xvciA9ICd3aGl0ZSc7XG5cdGRlbFR5cGUuY29udGVudCA9ICdkZWwnO1xuXHR0aGlzLnR5cGUuYWRkQ2hpbGQoZGVsVHlwZSk7XG5cblx0dmFyIHJldHVyblR5cGUgPSBuZXcgcGFwZXIuUG9pbnRUZXh0KG5ldyBwYXBlci5Qb2ludChydEtleS5ib3VuZHMuYm90dG9tUmlnaHQueCAtIG1hcmdpbiwgcnRLZXkuYm91bmRzLmJvdHRvbVJpZ2h0LnkgLSBtYXJnaW4pKTtcblx0cmV0dXJuVHlwZS5qdXN0aWZpY2F0aW9uID0gJ3JpZ2h0Jztcblx0cmV0dXJuVHlwZS5mb250U2l6ZSA9IHR5cGVTaXplO1xuXHRyZXR1cm5UeXBlLmZvbnRGYW1pbHk9ICdSb2JvdG8nO1xuXHRyZXR1cm5UeXBlLmZpbGxDb2xvciA9ICd3aGl0ZSc7XG5cdHJldHVyblR5cGUuY29udGVudCA9ICdyZXR1cm4nO1xuXHR0aGlzLnR5cGUuYWRkQ2hpbGQocmV0dXJuVHlwZSk7XG5cblx0aWYocGFwZXIudmlldy5ib3VuZHMud2lkdGggPCAxMDAwKSB7XG5cdFx0cmV0dXJuVHlwZS5jb250ZW50ID0gXCLigKJcIjtcblx0XHRkZWxUeXBlLmNvbnRlbnQgPSBcIuKGkFwiO1xuXHR9XG5cblx0dGhpcy5rZXlib2FyZC5zdHlsZSA9IHtcblx0XHRmaWxsQ29sb3I6IFwiIzgwODA4MFwiLFxuXHRcdHN0cm9rZUNvbG9yOiBuZXcgcGFwZXIuQ29sb3IoMSwxLDEsMC40KSxcblx0XHRzdHJva2VXaWR0aDogMS41LFxuXHRcdHNoYWRvd0NvbG9yOiBuZXcgcGFwZXIuQ29sb3IoMCwwLDAsMC40NSksXG5cdFx0c2hhZG93Qmx1cjogNCxcblx0XHRzaGFkb3dPZmZzZXQ6IG5ldyBwYXBlci5Qb2ludCgwLCAyKVxuXHR9XG5cbn1cblxuS2V5Ym9hcmQucHJvdG90eXBlLmRyYXdQYXRoID0gZnVuY3Rpb24oKSB7XG5cblx0dGhpcy5wYXRoLnN0eWxlID0ge1xuXHRcdHN0cm9rZVdpZHRoIDogNixcblx0XHRmaWxsQ29sb3I6IG5ldyBwYXBlci5Db2xvcigwLDAsMCwwKSxcblx0XHRzdHJva2VDYXAgOiAncm91bmQnLFxuXHRcdHN0cm9rZUpvaW4gOiAncm91bmQnXG5cdH1cblxuXHR0aGlzLnBhdGguc3Ryb2tlQ29sb3IgPSB7XG5cdFx0Z3JhZGllbnQ6IHtcblx0XHRcdHN0b3BzOiBbbmV3IHBhcGVyLkNvbG9yKCcjMDBGRkY0JyksIG5ldyBwYXBlci5Db2xvcignIzFGMDBGRicpXVxuXHRcdH0sXG5cdFx0b3JpZ2luOiB0aGlzLmRlYnVnLmJvdW5kaW5nQm94LmJvdW5kcy5sZWZ0Q2VudGVyLFxuXHRcdGRlc3RpbmF0aW9uOiB0aGlzLmRlYnVnLmJvdW5kaW5nQm94LmJvdW5kcy5yaWdodENlbnRlclxuXHR9XG5cblx0Zm9yICh2YXIgaSA9IHRoaXMucGF0aFBvaW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdHRoaXMucGF0aC5hZGQodGhpcy5rZXlib2FyZC5jaGlsZHJlblt0aGlzLnBhdGhQb2ludHNbaV1dLmJvdW5kcy5jZW50ZXIpO1xuXHR9XG5cblx0dGhpcy5wYXRoLnNtb290aCgpO1xuXG59XG5cbktleWJvYXJkLnByb3RvdHlwZS5sb2NhdGVLZXkgPSBmdW5jdGlvbihrZXksIGxvY2F0aW9uKSB7XG5cblx0dmFyIGluZGV4ID0gbnVsbFxuXG5cdGNvbnNvbGUubG9nKGtleSk7XG5cblx0aWYobG9jYXRpb24gPT0gMSB8fCBsb2NhdGlvbiA9PSAwKSB7XG5cblx0XHQvLyBMZWZ0IHNpZGVcblx0XHRcblx0XHRmb3IgKHZhciBpID0gdGhpcy5rZXlNYXAubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdGlmKHRoaXMua2V5TWFwW2ldID09IGtleSkgaW5kZXggPSBpO1xuXHRcdH1cblxuXHRcdGlmKGluZGV4ID09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdObyBtYXRjaCcpO1xuXHRcdH1cblxuXHR9XG5cdGVsc2UgaWYobG9jYXRpb24gPT0gMikge1xuXG5cdFx0Ly8gUmlnaHQgc2lkZVxuXG5cdFx0aWYoa2V5ID09IFwibWV0YVwiKSB7XG5cdFx0XHRpbmRleCA9IDU3O1xuXHRcdH1cblxuXHRcdGlmKGtleSA9PSBcImFsdFwiKSB7XG5cdFx0XHRpbmRleCA9IDU4O1xuXHRcdH1cblxuXHRcdGlmKGtleSA9PSBcImNvbnRyb2xcIikge1xuXHRcdFx0aW5kZXggPSA1OTtcblx0XHR9XG5cblx0XHRpZihrZXkgPT0gXCJzaGlmdFwiKSB7XG5cdFx0XHRpbmRleCA9IDUyO1xuXHRcdH1cblxuXHR9XG5cblx0cmV0dXJuIGluZGV4O1xuXG59XG5cbktleWJvYXJkLnByb3RvdHlwZS5vbktleURvd24gPSBmdW5jdGlvbihrZXksIGxvY2F0aW9uKSB7XG5cblx0dmFyIGluZGV4ID0gdGhpcy5sb2NhdGVLZXkoa2V5LCBsb2NhdGlvbik7XG5cblx0dGhpcy5wYXRoUG9pbnRzLnB1c2goaW5kZXgpO1xuXHRjb25zb2xlLmxvZyh0aGlzLnBhdGguc2VnbWVudHMpO1xuXG5cdHRoaXMua2V5Ym9hcmQuY2hpbGRyZW5baW5kZXhdLnNoYWRvd0NvbG9yID0gbmV3IHBhcGVyLkNvbG9yKDAsMCwwLDAuMik7XG5cdHRoaXMua2V5Ym9hcmQuY2hpbGRyZW5baW5kZXhdLnNoYWRvd0JsdXIgPSAxO1xuXHR0aGlzLmtleWJvYXJkLmNoaWxkcmVuW2luZGV4XS5zaGFkb3dPZmZzZXQgPSBuZXcgcGFwZXIuUG9pbnQoMCwgMSk7XG5cblx0aWYoa2V5ID09IFwiYmFja3NwYWNlXCIpIHtcblx0XHR0aGlzLmRlbGV0ZSgpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmKGtleSA9PSBcImVudGVyXCIpIHtcblx0XHRwYXBlci52aWV3LmRyYXcoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHR0aGlzLnBhdGguYWRkKHRoaXMua2V5Ym9hcmQuY2hpbGRyZW5baW5kZXhdLmJvdW5kcy5jZW50ZXIpO1xuXHR0aGlzLnBhdGguc21vb3RoKCk7XG5cblx0cGFwZXIudmlldy5kcmF3KCk7XG5cblx0Ly8gdGhpcy5hZGRUb1RleHQoa2V5KTtcblx0Ly8gdGhpcy5hZGRUb1BhdGgoaW5kZXgpO1xuXG59XG5cbktleWJvYXJkLnByb3RvdHlwZS5vbktleVVwID0gZnVuY3Rpb24oa2V5LCBsb2NhdGlvbikge1xuXG5cdGZvciAodmFyIGkgPSB0aGlzLmtleWJvYXJkLmNoaWxkcmVuLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XG5cdFx0dGhpcy5rZXlib2FyZC5jaGlsZHJlbltpXS5zaGFkb3dDb2xvciA9IG5ldyBwYXBlci5Db2xvcigwLDAsMCwwLjQ1KTtcblx0XHR0aGlzLmtleWJvYXJkLmNoaWxkcmVuW2ldLnNoYWRvd0JsdXIgPSA0O1xuXHRcdHRoaXMua2V5Ym9hcmQuY2hpbGRyZW5baV0uc2hhZG93T2Zmc2V0ID0gbmV3IHBhcGVyLlBvaW50KDAsIDIpO1xuXG5cdH1cblxuXHRpZihrZXkgPT0gXCJlbnRlclwiKSB7XG5cdFx0aWYodGhpcy5wYXRoLnNlZ21lbnRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdHRoaXMucmVzZXRBbGwoKTtcblx0XHR9XG5cdH1cblxuXHRwYXBlci52aWV3LmRyYXcoKTtcbn1cblxuS2V5Ym9hcmQucHJvdG90eXBlLmFkZFRvVGV4dCA9IGZ1bmN0aW9uKGNoYXJhY3Rlcikge1xuXG5cdHRoaXMudGV4dC5wdXNoKGNoYXJhY3Rlcik7XG5cbn1cblxuS2V5Ym9hcmQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uKCkge1xuXG5cdHRoaXMucGF0aC5yZW1vdmVTZWdtZW50KHRoaXMucGF0aC5zZWdtZW50cy5sZW5ndGgtMSk7XG5cdHRoaXMudGV4dC5wb3AoKTtcblxuXHRwYXBlci52aWV3LmRyYXcoKTtcblxufVxuXG5LZXlib2FyZC5wcm90b3R5cGUucmVzZXRBbGwgPSBmdW5jdGlvbigpIHtcblxuXHR0aGlzLnBhdGgucmVtb3ZlU2VnbWVudHMoKTtcblx0dGhpcy50ZXh0ID0gW107XG5cbn0iLCJ2YXIgTG9hZGVyID0ge1xuXG5cdHF1ZXVlIDogdW5kZWZpbmVkLFxuXG5cdGluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMucXVldWUgPSBuZXcgY3JlYXRlanMuTG9hZFF1ZXVlKCk7XG5cdFx0dGhpcy5xdWV1ZS5vbignY29tcGxldGUnLCB0aGlzLm9uTG9hZENvbXBsZXRlZCk7XG5cdFx0dGhpcy5xdWV1ZS5vbignZXJyb3InLCB0aGlzLm9uTG9hZEVycm9yKTtcblx0XHR0aGlzLnF1ZXVlLm9uKCdwcm9ncmVzcycsIHRoaXMub25Mb2FkUHJvZ3Jlc3MpO1xuXHR9LFxuXG5cdGxvYWQ6IGZ1bmN0aW9uKG1hbmlmZXN0LCBvbkxvYWRlZCkge1xuXHRcdGNvbnNvbGUubG9nKCdMb2FkaW5nOicsIG1hbmlmZXN0WzBdLnNyYyk7XG5cdFx0dmFyIHEgPSB0aGlzLnF1ZXVlO1xuXHRcdHEub24oJ2NvbXBsZXRlJywgb25Mb2FkZWQpO1xuXHRcdHEubG9hZE1hbmlmZXN0KG1hbmlmZXN0KTtcblx0fSxcblxuXHRnZXRDb250ZW50QnlJZDogZnVuY3Rpb24oaWQpIHtcblx0XHRyZXR1cm4gdGhpcy5xdWV1ZS5nZXRSZXN1bHQoaWQpO1xuXHR9LFxuXG5cdG9uTG9hZENvbXBsZXRlZDogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc29sZS5sb2coJ0xvYWQgQ29tcGxldGVkJyk7XG5cdH0sXG5cblx0b25Mb2FkRXJyb3I6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKCdMb2FkIEVycm9yJyk7XG5cdH0sXG5cblx0b25Mb2FkUHJvZ3Jlc3M6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKCcuJyk7XG5cdH0sXG5cdFxufTsiLCJ2YXIgQXBwID0ge1xuXG5cdGNvbnRhaW5lcjogdW5kZWZpbmVkLFxuXG5cdGluaXQ6IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdExvYWRlci5pbml0KCk7XG5cdFx0dGhpcy5pbml0aWFsTG9hZCgpO1xuXHR9LFxuXG5cdGluaXRpYWxMb2FkOiBmdW5jdGlvbigpIHtcblx0XHRMb2FkZXIubG9hZChbXG5cdFx0XHR7aWQ6ICdob21lcGFnZScsIHNyYzogJ2RhdGEvaG9tZXBhZ2UuaHRtbCd9XG5cdFx0XSwgdGhpcy5sb2FkQ29tcGxldGVkLmJpbmQodGhpcykpOyAvLyBCaW5kaW5nIGFsbG93cyB0byBrZWVwIHRoZSBBcHAgc2NvcGUgb24gY2FsbGJhY2tcblx0fSxcblxuXHRsb2FkQ29tcGxldGVkOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmNvbnRhaW5lci5pbm5lckhUTUwgPSBMb2FkZXIuZ2V0Q29udGVudEJ5SWQoJ2hvbWVwYWdlJyk7XG5cdFx0dGhpcy5pbml0aWFsVHJhbnNpdGlvbkluKCk7XG5cdH0sXG5cblx0aW5pdGlhbFRyYW5zaXRpb25JbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgnZmFkZS1pbicpO1xuXHRcdGNvbnNvbGUubG9nKCdbUEFOXSDimJHvuI8nKTtcblx0XHRLZXlib2FyZCA9IG5ldyBLZXlib2FyZCgpO1xuXHR9LFxuXG5cdGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuXHR9XG5cbn07IiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG5cblx0Y29uc29sZS5sb2coJ/CfkbsnKTtcblx0QXBwLmluaXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpKTtcblxufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
